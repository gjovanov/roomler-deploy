graph TB
    subgraph Internet
        U["Users"]
        WR["WebRTC Clients"]
    end

    subgraph Host["Bare Metal Host"]
        NGX["Docker: nginx<br/>(stays on host â€” HTTP/3, Brotli, GeoIP2)"]
    end

    subgraph K8s["K8s Cluster"]
        subgraph Roomler["namespace: roomler"]
            APP["Roomler Pod<br/>Nuxt SSR + Fastify<br/>PM2 cluster x4"]
            MG["MongoDB 7.x<br/>StatefulSet<br/>PV: 5Gi"]
            RD["Redis 7<br/>Alpine<br/>(pub/sub, no persistence)"]
            JN["Janus Gateway<br/>hostNetwork<br/>WebRTC SFU"]
        end

        subgraph COTURN["namespace: coturn"]
            CT1["COTURN Worker1"]
            CT2["COTURN Worker2"]
        end
    end

    U -->|"HTTPS"| NGX
    WR -->|"WSS"| NGX
    NGX -->|":30030"| APP
    NGX -->|":30818"| JN
    APP --> MG
    APP --> RD

    style Host fill:#1a1a2e,color:#fff
    style Roomler fill:#533483,color:#fff
    style COTURN fill:#0f3460,color:#fff
